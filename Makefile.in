
SUBDIRS=libvbi libng src man radio font tools webcam http #i2c vtx

all build dep depend install clean distclean realclean::
	set -ex; for dir in $(SUBDIRS); do	\
		(cd $$dir; $(MAKE) $@);		\
	done

distclean realclean::
	-rm -f *~ debian/*~ config.cache config.h config.log config.status Makefile
	cp Makefile.clean Makefile


#########################################################
# just for me, some maintaining jobs.  Don't use them

VERSION=@XAWTV_VERSION@

realclean::
	find . -name snap0*.ppm  -print | xargs -i rm -f
	find . -name snap0*.jpeg -print | xargs -i rm -f
	find . -name .nfs* -print | xargs -i rm -f
	set -e; for dir in i2c; do make -C $$dir distclean; done

diff:
	last=`ls -t $(HOME)/strusel/linux/xawtv/xawtv_*.tar.gz | head -1`;\
	tardiff $$last . | gzip > ../xawtv_$(VERSION).diff.gz

checkit: distclean
	dpkg-buildpackage -tc -us -uc -rfakeroot
#	rpm -ta ../xawtv_*.tar.gz
	lintian ../xawtv_*.changes

#release: realclean diff
release: distclean diff
#	make -C font bdf
	dpkg-buildpackage -tc -rfakeroot

port:
	dpkg-buildpackage -b -tc -rfakeroot

tarball: distclean
	(cd ..; tar cvzf xawtv_$(VERSION).tar.gz \
		xawtv-$(VERSION))

auto:
	rm -f config.cache
	autoconf
	autoheader
	./configure

