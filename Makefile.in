
SUBDIRS=libvbi src man radio font tools webcam http #i2c vtx

all build dep depend install clean distclean realclean::
	set -e; for dir in $(SUBDIRS); do $(MAKE) -C $$dir $@; done

distclean realclean::
	-rm -f *~ debian/*~ config.cache config.h config.log config.status Makefile
	cp Makefile.clean Makefile


#########################################################
# just for me, some maintaining jobs.  Don't use them

RPM=/home/ftp/rpm
VERSION=@XAWTV_VERSION@

realclean::
	find . -name snap0*.ppm  -print | xargs -i rm -f
	find . -name snap0*.jpeg -print | xargs -i rm -f
	find . -name .nfs* -print | xargs -i rm -f
	set -e; for dir in i2c; do make -C $$dir distclean; done

checkit: distclean
	dpkg-buildpackage -tc -us -uc -rfakeroot
	rpm -ta ../xawtv_*.tar.gz
	lintian ../xawtv_*.changes

diff:
	(cd /tmp; tar xvzf `ls -t $(HOME)/debian/Archive/xawtv_*.tar.gz | head -n 1`)
	(cd ..; diff -urN /tmp/xawtv-* xawtv-$(VERSION) | gzip > xawtv_$(VERSION).diff.gz)
	rm -rf /tmp/xawtv-*

release: realclean diff
	make -C font bdf
	dpkg-buildpackage -tc -rfakeroot

port:
	dpkg-buildpackage -b -tc -rfakeroot

