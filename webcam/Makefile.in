srcdir=@srcdir@
VPATH=$(srcdir)

ROOT=
prefix=@prefix@
exec_prefix=@exec_prefix@
bindir=$(ROOT)@bindir@
mandir=$(ROOT)@mandir@

OS:=$(shell uname -s | tr "A-Z" "a-z")

CC=@CC@
CFLAGS=-O2 -Wall -I$(srcdir)/.. -I.. -D_GNU_SOURCE

INSTALL=@INSTALL@
INSTALL_PROGRAM=@INSTALL_PROGRAM@
INSTALL_DATA=@INSTALL_DATA@
INSTALL_DIR=mkdir -p

ifeq ($(OS),linux)
  PROGS=webcam
else
  PROGS=
endif

OBJS=webcam.o ftp.o parseconfig.o

##########################################################################

all build: $(PROGS)

webcam: $(OBJS)
	$(CC) $(CFLAGS) -o $@ $(OBJS) -ljpeg

install: all
	$(INSTALL_DIR) $(bindir)
	$(INSTALL_DIR) $(mandir)/man1
	$(INSTALL_PROGRAM) -s webcam $(bindir)
	$(INSTALL_DATA) $(srcdir)/webcam.man $(mandir)/man1/webcam.1

clean:
	-rm -f $(OBJS) *.moc core* TAGS

realclean distclean: clean
	-rm -f $(PROGS) Makefile *~ *.bak

dep depend install:
